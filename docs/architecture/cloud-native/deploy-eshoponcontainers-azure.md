---
title: Implementación de eShopOnContainers en Azure
description: Implementación de la aplicación eShopOnContainers con Azure Kubernetes Service, Helm y DevSpaces.
ms.date: 06/30/2019
ms.openlocfilehash: 21033cc904dc595193c69f3452ce2522740f8ff6
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/23/2019
ms.locfileid: "73840494"
---
# <a name="deploying-eshoponcontainers-to-azure"></a><span data-ttu-id="0e160-103">Implementación de eShopOnContainers en Azure</span><span class="sxs-lookup"><span data-stu-id="0e160-103">Deploying eShopOnContainers to Azure</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="0e160-104">La lógica compatible con la aplicación eShopOnContainers puede ser compatible con Azure mediante una variedad de servicios.</span><span class="sxs-lookup"><span data-stu-id="0e160-104">The logic supporting the eShopOnContainers application can be supported by Azure using a variety of services.</span></span> <span data-ttu-id="0e160-105">El enfoque recomendado es aprovechar Kubernetes con Azure Kubernetes Service (AKS).</span><span class="sxs-lookup"><span data-stu-id="0e160-105">The recommended approach is to leverage Kubernetes using Azure Kubernetes Service (AKS).</span></span> <span data-ttu-id="0e160-106">Esto se puede combinar con la implementación de Helm para garantizar una configuración de infraestructura repetida fácilmente.</span><span class="sxs-lookup"><span data-stu-id="0e160-106">This can be combined with Helm deployment to ensure easily repeated infrastructure configuration.</span></span> <span data-ttu-id="0e160-107">Opcionalmente, los desarrolladores pueden aprovechar Azure Dev Spaces para Kubernetes como parte de su proceso de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="0e160-107">Optionally, developers can leverage Azure Dev Spaces for Kubernetes as part of their development process.</span></span> <span data-ttu-id="0e160-108">Otra opción es hospedar la funcionalidad de la aplicación con características sin servidor de Azure como Azure Functions y Azure Logic Apps.</span><span class="sxs-lookup"><span data-stu-id="0e160-108">Another option is to host the functionality of the app using Azure Serverless features like Azure Functions and Azure Logic Apps.</span></span>

## <a name="azure-kubernetes-service"></a><span data-ttu-id="0e160-109">Azure Kubernetes Service</span><span class="sxs-lookup"><span data-stu-id="0e160-109">Azure Kubernetes Service</span></span>

<span data-ttu-id="0e160-110">Si desea hospedar la aplicación eShopOnContainers en su propio clúster de AKS, el primer paso es crear el clúster.</span><span class="sxs-lookup"><span data-stu-id="0e160-110">If you'd like to host the eShopOnContainers application in your own AKS cluster, the first step is to create your cluster.</span></span> <span data-ttu-id="0e160-111">Puede hacerlo mediante el Azure Portal, que le guiará a través de los pasos necesarios, o bien puede usar el CLI de Azure, con cuidado para asegurarse de habilitar el Access Control basado en roles (RBAC) y el enrutamiento de la aplicación cuando lo haga.</span><span class="sxs-lookup"><span data-stu-id="0e160-111">You can do this using the Azure portal, which will walk you through the required steps, or you can use the Azure CLI, taking care to ensure you enable Role-Based Access Control (RBAC) and application routing when you do so.</span></span> <span data-ttu-id="0e160-112">La documentación de eShopOnContainers describe los pasos necesarios para crear su propio clúster de AKS.</span><span class="sxs-lookup"><span data-stu-id="0e160-112">The eShopOnContainers' documentation describes the steps involved in creating your own AKS cluster.</span></span> <span data-ttu-id="0e160-113">Una vez creado el clúster, debe habilitar el acceso al panel de Kubernetes, en el que debería poder ir al panel de Kubernetes para administrar el clúster.</span><span class="sxs-lookup"><span data-stu-id="0e160-113">Once the cluster is created, you must enable access to the Kubernetes dashboard, at which point you should be able to browse to the Kubernetes dashboard to manage the cluster.</span></span>

<span data-ttu-id="0e160-114">Una vez que se ha creado y configurado el clúster, puede implementar la aplicación en él mediante Helm y el uso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="0e160-114">Once the cluster has been created and configured, you can deploy the application to it using Helm and Tiller.</span></span>

## <a name="deploying-to-azure-kubernetes-service-using-helm"></a><span data-ttu-id="0e160-115">Implementación en Azure Kubernetes Service con Helm</span><span class="sxs-lookup"><span data-stu-id="0e160-115">Deploying to Azure Kubernetes Service using Helm</span></span>

<span data-ttu-id="0e160-116">Las implementaciones básicas en AKS pueden usar scripts de la CLI personalizados o archivos de implementación simples, pero las aplicaciones más complejas deben usar una herramienta de administración de dependencias como Helm.</span><span class="sxs-lookup"><span data-stu-id="0e160-116">Basic deployments to AKS may use custom CLI scripts or simple deployment files, but more complex applications should use a dependency management tool like Helm.</span></span> <span data-ttu-id="0e160-117">Helm se mantiene en la base informática nativa de la nube y le ayuda a definir, instalar y actualizar las aplicaciones de Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="0e160-117">Helm is maintained by the Cloud-native Computing Foundation and helps you define, install, and upgrade Kubernetes applications.</span></span> <span data-ttu-id="0e160-118">Helm se compone de un cliente de línea de comandos, Helm, que usa gráficos de Helm, y un componente en clúster, con el fin de utilizarlo.</span><span class="sxs-lookup"><span data-stu-id="0e160-118">Helm is composed of a command-line client, helm, which uses helm charts, and an in-cluster component, Tiller.</span></span> <span data-ttu-id="0e160-119">Los gráficos de Helm usan archivos estándar con formato YAML para describir un conjunto relacionado de recursos de Kubernetes y suelen tener versiones junto a la aplicación que describen.</span><span class="sxs-lookup"><span data-stu-id="0e160-119">Helm Charts use standard YAML-formatted files to describe a related set of Kubernetes resources and are typically versioned alongside the application they describe.</span></span> <span data-ttu-id="0e160-120">Los gráficos Helm van desde simple a complejo, en función de los requisitos de la instalación que describen.</span><span class="sxs-lookup"><span data-stu-id="0e160-120">Helm Charts range from simple to complex depending on the requirements of the installation they describe.</span></span>

<span data-ttu-id="0e160-121">Encontrará los gráficos de eShopOnContainers Helm en la carpeta/K8S/Helm.</span><span class="sxs-lookup"><span data-stu-id="0e160-121">You'll find the eShopOnContainers helm charts in the /k8s/helm folder.</span></span> <span data-ttu-id="0e160-122">En la figura 2-6 se muestra cómo se organizan los distintos componentes de la aplicación en una estructura de carpetas que usa Helm para definir y administrar las implementaciones.</span><span class="sxs-lookup"><span data-stu-id="0e160-122">Figure 2-6 shows how the different components of the application are organized into a folder structure used by helm to define and managed deployments.</span></span>

<span data-ttu-id="0e160-123">![arquitectura de eShopOnContainers](./media/eshoponcontainers-helm-folder.png)
**figura 2-6**.</span><span class="sxs-lookup"><span data-stu-id="0e160-123">![eShopOnContainers Architecture](./media/eshoponcontainers-helm-folder.png)
**Figure 2-6**.</span></span> <span data-ttu-id="0e160-124">La carpeta eShopOnContainers Helm</span><span class="sxs-lookup"><span data-stu-id="0e160-124">The eShopOnContainers helm folder.</span></span>

<span data-ttu-id="0e160-125">Cada componente individual se instala mediante un comando `helm install`.</span><span class="sxs-lookup"><span data-stu-id="0e160-125">Each individual component is installed using a `helm install` command.</span></span> <span data-ttu-id="0e160-126">Estos comandos se pueden incluir fácilmente en el script, y eShopOnContainers proporciona un script "implementar todo" que recorre los distintos componentes y los instala mediante sus respectivos gráficos de Helm.</span><span class="sxs-lookup"><span data-stu-id="0e160-126">These commands are easily scripted, and eShopOnContainers provides a "deploy all" script that loops through the different components and installs them using their respective helm charts.</span></span> <span data-ttu-id="0e160-127">El resultado es un proceso repetible, con versiones de la aplicación en el control de código fuente, que cualquier persona del equipo puede implementar en un clúster de AKS con un comando de script de una línea.</span><span class="sxs-lookup"><span data-stu-id="0e160-127">The result is a repeatable process, versioned with the application in source control, that anyone on the team can deploy to an AKS cluster with a one-line script command.</span></span> <span data-ttu-id="0e160-128">Especialmente cuando se combina con Azure Dev Spaces, esto facilita a los desarrolladores el diagnóstico y la prueba de sus cambios individuales en sus aplicaciones nativas en la nube basadas en microservicios.</span><span class="sxs-lookup"><span data-stu-id="0e160-128">Especially when combined with Azure Dev Spaces, this makes it easy for developers to diagnose and test their individual changes to their microservice-based cloud-native apps.</span></span>

## <a name="azure-dev-spaces"></a><span data-ttu-id="0e160-129">Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="0e160-129">Azure Dev Spaces</span></span>

<span data-ttu-id="0e160-130">Azure Dev Spaces ayuda a los desarrolladores individuales a hospedar su propia versión única de los clústeres de AKS en Azure durante el desarrollo.</span><span class="sxs-lookup"><span data-stu-id="0e160-130">Azure Dev Spaces helps individual developers host their own unique version of AKS clusters in Azure during development.</span></span> <span data-ttu-id="0e160-131">Esto minimiza los requisitos de la máquina local y permite a los miembros del equipo ver rápidamente cómo se comportarán los cambios en un entorno de AKS real.</span><span class="sxs-lookup"><span data-stu-id="0e160-131">This minimizes local machine requirements and allows team members to quickly see how their changes will behave in a real AKS environment.</span></span> <span data-ttu-id="0e160-132">Azure Dev Spaces ofrece una CLI para que los desarrolladores puedan usar para administrar sus espacios de desarrollo y realizar implementaciones en un espacio de desarrollo secundario específico según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="0e160-132">Azure Dev Spaces offers a CLI for developers to use to manage their dev spaces and to deploy to a specific child dev space as needed.</span></span> <span data-ttu-id="0e160-133">Se hace referencia a cada espacio de desarrollo secundario mediante un subdominio URL único, que permite implementaciones en paralelo de clústeres modificados para que los desarrolladores individuales puedan evitar conflictos con el trabajo en curso.</span><span class="sxs-lookup"><span data-stu-id="0e160-133">Each child dev space is referenced using a unique URL subdomain, allowing side-by-side deployments of modified clusters so that individual developers can avoid conflicting with each other's work in progress.</span></span> <span data-ttu-id="0e160-134">En la figura 2-7 puede ver cómo Developer Susie ha implementado su propia versión del microservicio Bikes en su espacio de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="0e160-134">In Figure 2-7 you can see how developer Susie has deployed her own version of the Bikes microservice into her dev space.</span></span> <span data-ttu-id="0e160-135">Después, puede probar los cambios mediante una dirección URL personalizada que empiece por el nombre de su espacio (susie.s.dev.myapp.eus.azds.io).</span><span class="sxs-lookup"><span data-stu-id="0e160-135">She's then able to test her changes using a custom URL starting with the name of her space (susie.s.dev.myapp.eus.azds.io).</span></span>

<span data-ttu-id="0e160-136">![arquitectura de eShopOnContainers](./media/azure-devspaces-one.png)
**figura 2-7**.</span><span class="sxs-lookup"><span data-stu-id="0e160-136">![eShopOnContainers Architecture](./media/azure-devspaces-one.png)
**Figure 2-7**.</span></span> <span data-ttu-id="0e160-137">Developer Susie implementa su propia versión del microservicio Bikes y la prueba.</span><span class="sxs-lookup"><span data-stu-id="0e160-137">Developer Susie deploys her own version of the Bikes microservice and tests it.</span></span>

<span data-ttu-id="0e160-138">Al mismo tiempo, el desarrollador John está personalizando el microservicio de reservas y necesita probar sus cambios.</span><span class="sxs-lookup"><span data-stu-id="0e160-138">At the same time, developer John is customizing the Reservations microservice and needs to test his changes.</span></span> <span data-ttu-id="0e160-139">Puede implementar sus cambios en su propio espacio de desarrollo sin entrar en conflicto con los cambios de Susie como se muestra en la figura 2-8.</span><span class="sxs-lookup"><span data-stu-id="0e160-139">He's able to deploy his changes to his own dev space without conflicting with Susie's changes as shown in Figure 2-8.</span></span> <span data-ttu-id="0e160-140">Puede probar sus cambios con su propia dirección URL, que tiene como prefijo el nombre de su espacio (john.s.dev.myapp.eus.azds.io).</span><span class="sxs-lookup"><span data-stu-id="0e160-140">He can test his changes using his own URL which is prefixed with the name of his space (john.s.dev.myapp.eus.azds.io).</span></span>

<span data-ttu-id="0e160-141">![arquitectura de eShopOnContainers](./media/azure-devspaces-two.png)
**figura 2-8**.</span><span class="sxs-lookup"><span data-stu-id="0e160-141">![eShopOnContainers Architecture](./media/azure-devspaces-two.png)
**Figure 2-8**.</span></span> <span data-ttu-id="0e160-142">El desarrollador John implementa su propia versión del microservicio de reservas y la prueba sin conflictos con otros desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="0e160-142">Developer John deploys his own version of the Reservations microservice and tests it without conflicting with other developers.</span></span>

<span data-ttu-id="0e160-143">Con Azure Dev Spaces, los equipos pueden trabajar directamente con AKS mientras cambian, implementan y prueban sus cambios de forma independiente.</span><span class="sxs-lookup"><span data-stu-id="0e160-143">Using Azure Dev Spaces, teams can work directly with AKS while independently changing, deploying, and testing their changes.</span></span> <span data-ttu-id="0e160-144">Este enfoque reduce la necesidad de entornos hospedados dedicados independientes, ya que todos los desarrolladores tienen su propio entorno de AKS.</span><span class="sxs-lookup"><span data-stu-id="0e160-144">This approach reduces the need for separate dedicated hosted environments since every developer effectively has their own AKS environment.</span></span> <span data-ttu-id="0e160-145">Los desarrolladores pueden trabajar con Azure Dev Spaces mediante su CLI o iniciar su aplicación para Azure Dev Spaces directamente desde Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0e160-145">Developers can work with Azure Dev Spaces using its CLI or launch their application to Azure Dev Spaces directly from Visual Studio.</span></span> [<span data-ttu-id="0e160-146">Obtenga más información sobre cómo funciona Azure Dev Spaces y está configurado.</span><span class="sxs-lookup"><span data-stu-id="0e160-146">Learn more about how Azure Dev Spaces works and is configured.</span></span>](https://docs.microsoft.com/azure/dev-spaces/how-dev-spaces-works)

## <a name="azure-functions-and-logic-apps-serverless"></a><span data-ttu-id="0e160-147">Azure Functions y Logic Apps (sin servidor)</span><span class="sxs-lookup"><span data-stu-id="0e160-147">Azure Functions and Logic Apps (Serverless)</span></span>

<span data-ttu-id="0e160-148">El ejemplo eShopOnContainers incluye compatibilidad con el seguimiento de campañas de marketing en línea.</span><span class="sxs-lookup"><span data-stu-id="0e160-148">The eShopOnContainers sample includes support for tracking online marketing campaigns.</span></span> <span data-ttu-id="0e160-149">Una función de Azure se usa para extraer los detalles de la campaña de marketing de un identificador de campaña determinado.</span><span class="sxs-lookup"><span data-stu-id="0e160-149">An Azure Function is used to pull marketing campaign details for a given campaign ID.</span></span> <span data-ttu-id="0e160-150">En lugar de crear una aplicación ASP.NET Core completa con este fin, un único punto de conexión de Azure function es más sencillo y suficiente.</span><span class="sxs-lookup"><span data-stu-id="0e160-150">Rather than creating a complete ASP.NET Core application for this purpose, a single Azure Function endpoint is simpler and sufficient.</span></span> <span data-ttu-id="0e160-151">Azure Functions tienen un modelo de compilación e implementación mucho más sencillo que las aplicaciones de ASP.NET Core completas, especialmente cuando se configura para ejecutarse en Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="0e160-151">Azure Functions have a much simpler build and deployment model than full ASP.NET Core applications, especially when configured to run in Kubernetes.</span></span> <span data-ttu-id="0e160-152">La implementación de la función se genera mediante scripts mediante plantillas Azure Resource Manager (ARM) y el CLI de Azure.</span><span class="sxs-lookup"><span data-stu-id="0e160-152">Deploying the function is scripted using Azure Resource Manager (ARM) templates and the Azure CLI.</span></span> <span data-ttu-id="0e160-153">El microservicio de detalles de la campaña no está orientado al cliente y no tiene los mismos requisitos que la tienda en línea, por lo que es un buen candidato para Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="0e160-153">This campaign details microservice isn't customer-facing and doesn't have the same requirements as the online store, making it a good candidate for Azure Functions.</span></span> <span data-ttu-id="0e160-154">La función requiere que alguna configuración funcione correctamente, como los datos de la cadena de conexión de base de datos y la configuración de URI base de la imagen.</span><span class="sxs-lookup"><span data-stu-id="0e160-154">The function requires some configuration to work properly, such as database connection string data and image base URI settings.</span></span> <span data-ttu-id="0e160-155">Configure Azure Functions en Azure portal.</span><span class="sxs-lookup"><span data-stu-id="0e160-155">You configure Azure Functions in the Azure Portal.</span></span>

## <a name="references"></a><span data-ttu-id="0e160-156">Referencias</span><span class="sxs-lookup"><span data-stu-id="0e160-156">References</span></span>

- <span data-ttu-id="0e160-157">[eShopOnContainers: creación de un clúster de Kubernetes en AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Deploy-to-Azure-Kubernetes-Service-(AKS)#create-kubernetes-cluster-in-aks)</span><span class="sxs-lookup"><span data-stu-id="0e160-157">[eShopOnContainers: Create Kubernetes cluster in AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Deploy-to-Azure-Kubernetes-Service-(AKS)#create-kubernetes-cluster-in-aks)</span></span>
- [<span data-ttu-id="0e160-158">eShopOnContainers: Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="0e160-158">eShopOnContainers: Azure Dev Spaces</span></span>](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Azure-Dev-Spaces)
- [<span data-ttu-id="0e160-159">Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="0e160-159">Azure Dev Spaces</span></span>](https://docs.microsoft.com/azure/dev-spaces/about)

>[!div class="step-by-step"]
><span data-ttu-id="0e160-160">[Anterior](map-eshoponcontainers-azure-services.md)
>[Siguiente](centralized-configuration.md)</span><span class="sxs-lookup"><span data-stu-id="0e160-160">[Previous](map-eshoponcontainers-azure-services.md)
[Next](centralized-configuration.md)</span></span>
